<!DOCTYPE html>
<!-- HTML5 Hello world by kirupa - http://www.kirupa.com/html5/getting_your_feet_wet_html5_pg1.htm -->
<html>

<head>
<meta charset="utf-8">
<title>Hello</title>
<style type="text/css">
.node {
    font: 300 11px"Helvetica Neue", Helvetica, Arial, sans-serif;
    font-weight: 600;
    fill: #000000;
}
.node:hover {
    fill: #000000;
}
.link {
    stroke: steelblue;
    stroke-opacity: .4;
    fill: none;
    pointer-events: none;
}
.node:hover, .node--source, .node--target, .node--both {
    font-weight: 700;
}
.node--source {
    fill: #2ca02c;
}
.node--target {
    fill: #d62728;
}
.node--both {
    fill: orange;
}
.link--source, .link--target, .link--both {
    stroke-opacity: 1;
    stroke-width: 2px;
}
.link--source {
    stroke: #d62728;
}
.link--target {
    stroke: #2ca02c;
}
.link--both {
    stroke: orange;
}
</style>
</head>

<body>
<div id="viz" />
<script type="text/javascript" src="./d3.min.js"></script>
<script type="text/javascript">
var classes = [

{
    "name": "경기스마트카드",
        "imports": []
},
{
    "name": "대홍기획",
        "imports": ["롯데닷컴","모비쟆미디어","엠허브","롯데손해보험","롯데역사","롯데정보통신","롯데캐피탈"]
},
{
    "name": "데크항공",
        "imports": []
},
{
    "name": "동교청기와피에프브이",
        "imports": []
},
{
    "name": "디시네마오브코리아",
        "imports": []
},
{
    "name": "백학음료",
        "imports": []
},
{
    "name": "롯데건설",
        "imports": ["롯데쇼핑", "롯데인천개발","롯데인천타운","롯데자산개발","롯데제과","롯데캐피탈"]
},
{
    "name": "롯데김해개발",
        "imports": []
},
{
    "name": "롯데네슬레코리아",
        "imports": [""]
},
{
    "name": "롯데닷컴",
        "imports": ["롯데제이티비","롯데피에스넷"]
},
{
    "name": "롯데디에프글로벌",
        "imports": ["롯데디에프리테일"]
},
{
    "name": "롯데디에프리테일",
        "imports": []
},
{
    "name": "롯데로지스틱스",
        "imports": ["코리아세븐", "롯데상사","캐논코리아비즈니스솔루션"]
},
{
    "name": "롯데리아",
        "imports": ["대홍기획", "롯데자이언츠", "롯데로지스틱스", "롯데정보통신", "롯데캐피탈", "한국후지필름"]
},
{
    "name": "롯데멤버스",
        "imports": [""]
},
{
    "name": "롯데물산",
        "imports": ["롯데케미칼"]
},
{
    "name": "롯데미쓰이화학",
        "imports": []
},
{
    "name": "롯데백화점마산",
        "imports": []
},
{
    "name": "롯데베르살리스엘라스토머스",
        "imports": []
},
{
    "name": "롯데상사",
        "imports": ["롯데캐피탈", "캐논코리아비즈니스솔루션", "한국후지필름"]
},
{
    "name": "롯데손해보험",
        "imports": []
},
{
    "name": "롯데송도쇼핑타운",
        "imports": []
},
{
    "name": "롯데수원역쇼핑타운",
        "imports": []
},
{
    "name": "롯데쇼핑",
        "imports": ["대홍기획","디시네마오브코리아","롯데닷컴","롯데리아","롯데자이언츠","엔씨에프","우리홈쇼핑",
        "코리아세븐","롯데김해개발","롯데로지스틱스","롯데멤버스","롯데백화점마산","롯데상사","롯데송도쇼핑타운",
        "롯데수원역쇼핑타운","롯데알미늄","롯데역사","롯데인천개발","롯데인천타운","롯데자산개발","롯데카드",
        "롯데캐피탈","롯데푸드","롯데하이마트","씨에스유통","에프알엘코리아","은평피에프브이","한국에스티엘"]
},
{
    "name": "롯데아사히주류",
        "imports": []
},
{
    "name": "롯데알미늄",
        "imports": ["롯데자이언츠", "롯데건설", "롯데상사", "롯데제과","롯데칠성음료","캐논코리아비즈니스솔루션", "한국후지필름"]
},
{
    "name": "롯데엠알시",
        "imports": []
},
{
    "name": "롯데역사",
        "imports": ["롯데손해보험", "롯데송도쇼핑타운"]
},
{
    "name": "롯데인천개발",
        "imports": ["롯데송도쇼핑타운"]
},
{
    "name": "롯데인천타운",
        "imports": []
},
{
    "name": "롯데자산개발",
        "imports": ["동교청기와피에프브이", "롯데송도쇼핑타운", "롯데수원역쇼핑타운","마곡지구피에프이브", 
        "유니버셜스튜디오코리아리조트개발", "유니버셜스튜디오코리아리조트자산관리", "은평피에프브이","장교프로젝트금융투자"]
},
{
    "name": "롯데자이언츠",
        "imports": []
},
{
    "name": "롯데정보통신",
        "imports": ["마이비", "이비카드", "한페이시스", "롯데건설", "롯데쇼핑", "롯데역사", "롯데피에스넷", "캐논코리아비즈니스솔루션","현대정보기술"]
},
{
    "name": "롯데제과",
        "imports": ["롯데닷컴","롯데리아","롯데자이언츠","코리아세븐","롯데로지스틱스","롯데쇼핑","롯데역사",
        "롯데자산개발","롯데정보통신","롯데칠성음료","롯데푸드","한국후지필름"]
},
{
    "name": "롯데칠성음료",
        "imports": ["롯데닷컴","롯데리아","롯데아사히주류","롯데자이언츠","백학음료","충북소주","롯데건설","롯데로지스틱스",
        "롯데쇼핑","롯데자산개발","롯데정보통신","롯데캐피탈","롯데푸드","씨에이치음료","엠제이에이와인","한국후지필름"]
},
{
    "name": "롯데제이티비",
        "imports": []
},
{
    "name": "롯데카드",
        "imports": ["마이비","이비카드","삼박엘에프티"]
},
{
    "name": "롯데캐피탈",
        "imports": ["롯데멤버스","롯데카드"]
},
{
    "name": "롯데케미칼",
        "imports": ["씨텍","케이피켐텍","데크항공","롯데건설","롯데로지스틱스","롯데미쓰이화학","롯데베르살리스엘라스토머스",
        "롯데알미늄","롯데엠알시","롯데자산개발","롯데푸드","삼박엘에프티"]
},
{
    "name": "롯데푸드",
        "imports": ["대홍기획","롯데자이언츠","롯데네슬레코리아","롯데로지스틱스","롯데역사","롯데캐피탈"]
},
{
    "name": "롯데피에스넷",
        "imports": []
},
{
    "name": "롯데하이마트",
        "imports": []
},
{
    "name": "마곡지구피에프이브",
        "imports": []
},
{
    "name": "마이비",
        "imports": ["한페이시스","부산하나로카드"]
},
{
    "name": "모비쟆미디어",
        "imports": []
},
{
    "name": "바이더웨이",
        "imports": ["호텔롯데"]
},
{
    "name": "부산롯데호텔",
        "imports": ["롯데리아","마이비","부산롯데호텔","호텔롯데","롯데멤버스","롯데손해보험","롯데쇼핑",
        "롯데알미늄","롯데역사","롯데카드","롯데캐피탈","롯데푸드"]
},

{
    "name": "부산하나로카드",
        "imports": []
},
{
    "name": "삼박엘에프티",
        "imports": []
},
{
    "name": "씨에스유통",
        "imports": []
},
{
    "name": "씨에이치음료",
        "imports": []
},
{
    "name": "씨텍",
        "imports": []
},
{
    "name": "에치유아이",
        "imports": []
},
{
    "name": "에프알엘코리아",
        "imports": []
},
{
    "name": "엔씨에프",
        "imports": []
},
{
    "name": "엔젤위드",
        "imports": []
},
{
    "name": "엠제이에이와인",
        "imports": []
},
{
    "name": "엠허브",
        "imports": []
},
{
    "name": "우리홈쇼핑",
        "imports": []
},
{
    "name": "유니버셜스튜디오코리아리조트개발",
        "imports": []
},
{
    "name": "유니버셜스튜디오코리아리조트자산관리",
        "imports": []
},
{
    "name": "은평피에프브이",
        "imports": []
},
{
    "name": "이비카드",
        "imports": ["마이비", "경기스마트카드", "인천스마트카드"]
},
{
    "name": "이지스일호",
        "imports": ["현대로지스틱스"]
},
{
    "name": "인천스마트카드",
        "imports": []
},
{
    "name": "장교프로젝트금융투자",
        "imports": []
},
{
    "name": "충남스마트카드",
        "imports": []
},
{
    "name": "충북소주",
        "imports": ["에치유아이"]
},
{
    "name": "캐논코리아비즈니스솔루션",
        "imports": ["엔젤위드"]
},
{
    "name": "케이피켐텍",
        "imports": []
},
{
    "name": "코리아세븐",
        "imports": ["바이더웨이", "롯데피에스넷"]
},
{
    "name": "한국에스티엘",
        "imports": []
},
{
    "name": "한국후지필름",
        "imports": ["대홍기획","롯데자이언츠", "롯데쇼핑", "롯데캐피탈"]
},
{
    "name": "한페이시스",
        "imports": []
},
{
    "name": "현대로지스틱스",
        "imports": ["현대코스코로지스틱스"]
},
{
    "name": "현대정보기술",
        "imports": []
},
{
    "name": "현대코스코로지스틱스",
        "imports": []
},
{
    "name": "호텔롯데",
        "imports": ["대홍기획", "롯데닷컴", "롯데리아", "동교청기와피에프브이", "롯데건설", "롯데디에프글로벌",
        "롯데로지스틱스", "롯데물산", "롯데상사","롯데손해보험", "롯데쇼핑","롯데알미늄", "롯데인천개발", "롯데자산개발", 
        "롯데정보통신","롯데캐피탈", "롯데케미칼", "롯데푸드", "유니버셜스튜디오코리아리조트개발", "장교프로젝트금융투자", 
        "캐논코리아비즈니스솔루션", "한국후지필름"]
}

];


var diameter = 960,
    radius = diameter / 2,
    innerRadius = radius - 200;

var cluster = d3.layout.cluster()
    .size([360, innerRadius])
    .sort(null)
    .value(function (d) {
        return d.size;
    });

var bundle = d3.layout.bundle();

var line = d3.svg.line.radial()
    .interpolate("bundle")
    .tension(.85)
    .radius(function (d) {
        return d.y;
    })
    .angle(function (d) {
        return d.x / 180 * Math.PI;
    });

var svg = d3.select("#viz").append("svg")
    .attr("width", '1000')
    .attr("height", '860')
    .append("g")
    .attr("transform",
          "translate(" + radius + "," + radius + ")");

var link = svg.append("g").selectAll(".link"),
    node = svg.append("g").selectAll(".node");

//d3.json("hebtesting.json", function(error, classes) {
var nodes = cluster.nodes(packageHierarchy(classes)),
    links = packageImports(nodes);

var unique_links = links.reduce(function (p, c) {
    var index = p.map(function (d, i) {
        if (d.source === c.target && d.target === c.source)
            return i;
    })
    .shift();
    if (!isNaN(index))
        p[index].both = true;
    else
        p.push(c);
    return p;
}, []);

link = link.data(bundle(unique_links))
   .enter()
    .append("path")
    .each(function (d) {
        d.source = d[0],
        d.target = d[d.length - 1],
        d.both = unique_links.filter(function (v) {
            if (v.source === d.target && v.target === d.source){
                return v.both = d.both = true;
            }
        })
        .shift();
    })
    .attr("class", "link")
    .attr("d", line);

node = node.data(nodes.filter(function (n) {
        return !n.children;
    }))
   .enter()
    .append("text")
    .attr("class", "node")
    .attr("dy", ".31em")
    .attr("transform", function (d) {
        return "rotate(" + (d.x - 90) + ")translate(" + (d.y + 8) + ",0)" + (d.x < 180 ? "" : "rotate(180)");
    })
    .style("text-anchor", function (d) {
        return d.x < 180 ? "start" : "end";
    })
    .text(function (d) {
        return d.key;
    })
    .on("mouseover", mouseovered)
    .on("mouseout", mouseouted);
//});

function mouseovered(d) {
    node.each(function (n) {
        n.target = n.source = false;
    });

    link.classed("link--both", function (l) {
            if ((l.target === d || l.source === d) && l.both){
                return l.source.source = l.source.target = l.target.source = l.target.target = true;
            }
        })
        .classed("link--target", function (l) {
            if (l.target === d && !l.both)
                return l.source.source = true;
        })
        .classed("link--source", function (l) {
            if (l.source === d && !l.both)
                return l.target.target = true;
        })
        .filter(function (l) {
            return l.target === d || l.source === d;
        })
        .each(function () {
            this.parentNode.appendChild(this);
        });

    node.classed("node--both", function (n) {
            return n.target && n.source;
        })
        .classed("node--target", function (n) {
            return n.target;
        })
        .classed("node--source", function (n) {
            return n.source;
        });
}

function mouseouted(d) {
    link.classed("link--both", false)
        .classed("link--target", false)
        .classed("link--source", false);

    node.classed("node--both", false)
        .classed("node--target", false)
        .classed("node--source", false);
}

//d3.select(self.frameElement).style("height", diameter + "px");

// Lazily construct the package hierarchy from class names.
function packageHierarchy(classes) {
    var map = {};

    function find(name, data) {
        var node = map[name],
            i;
        if (!node) {
            node = map[name] = data || {
                name: name,
                children: []
            };
            if (name.length) {
                node.parent = find(name.substring(0, i = name.lastIndexOf(".")));
                node.parent.children.push(node);
                node.key = name.substring(i + 1);
            }
        }
        return node;
    }

    classes.forEach(function (d) {
        find(d.name, d);
    });

    return map[""];
}

// Return a list of imports for the given array of nodes.
function packageImports(nodes) {
    var map = {},
    imports = [];

    // Compute a map from name to node.
    nodes.forEach(function (d) {
        map[d.name] = d;
    });

    // For each import, construct a link from the source to target node.
    nodes.forEach(function (d) {
        if (d.imports) d.imports.forEach(function (i) {
            imports.push({
                source: map[d.name],
                target: map[i]
            });
        });
    });

    return imports;
}

</script>

</body>
</html>
   
